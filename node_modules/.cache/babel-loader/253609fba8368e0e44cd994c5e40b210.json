{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\test\\\\pixori-mint-test\\\\src\\\\App.js\";\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { Button } from '@material-ui/core';\nimport './styles/index.css';\nimport './styles/playhead.css';\nimport BeatMachine from './Components/BeatMachine';\nimport InstrumentRow from './Components/InstrumentRow';\nimport Bpm from './helpers/useBPM';\nimport BeatLabel from './Components/BeatLabel';\nimport CreateNft from './Components/CreateNft.jsx';\nimport Tempo from './Components/Tempo';\nimport { instruments, getBassNote } from './helpers/instruments';\nimport PlayButton from './Components/PlayButton';\nimport StopButton from './Components/StopButton';\nimport Volume from './Components/Volume';\nimport { Howl } from 'howler';\nimport Editor from \"./Editor\";\nimport useStyles from './App.styles';\nimport Colorbutton from \"./colorbutton\";\nimport { Fragment } from 'react';\nimport ColorPicker from './Components/ColorPicker.js';\nimport { MintCluster } from './clusters/mint-cluster';\nconst arr1 = Array.from(Array(16), () => new Array(32).fill(0));\nconst offCell = {\n  on: false,\n  color: '#000000'\n};\nconst initialCells = Array.from({\n  length: 40\n}, () => offCell);\n\nconst App = () => {\n  const [hideDrawingPanel, setHideDrawingPanel] = useState(true);\n  const [cells, setCells] = useState(initialCells);\n  const [selectedColor, setColor] = useState(\"000000\");\n  const classes = useStyles();\n  const colorSwatch = useMemo(() => [...new Set(cells.filter(cell => cell.on).map(cell => cell.color))], [cells]);\n  const chatString = useMemo(() => cells.map(cell => cell.color.slice(1)).join(','), [cells]);\n\n  function changeColor(color) {\n    setColor(color.hex);\n  } //beat machine initial states\n\n\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [tempo, setTempo] = useState(120);\n  const [volNum, setVolNum] = useState(50); // state tracking for playhead when isPlaying\n\n  const [squares, setSquares] = useState([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]); // state tracking for our dumb component when !isPlaying\n\n  const [playHeadArray, setPlayHeadArray] = useState([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n  const [counter, setCounter] = useState(0); // holds on off state for each row of instruments\n\n  const [grid, setGrid] = useState([instruments[0].pattern, instruments[1].pattern, instruments[2].pattern, instruments[3].pattern, instruments[4].pattern, instruments[5].pattern, instruments[6].pattern, instruments[7].pattern, instruments[8].pattern, instruments[9].pattern, instruments[10].pattern, instruments[11].pattern, instruments[12].pattern, instruments[13].pattern, instruments[14].pattern, instruments[15].pattern]); // TODO: Refactor player controls into helpers\n\n  const togglePlay = () => {\n    setIsPlaying(!isPlaying);\n  }; //set BPM\n\n\n  let beats = Bpm(tempo); //ParseInt() as tempo field currently a string\n\n  const handleTempoChange = event => {\n    const eventValue = event.target.value;\n    setTempo(parseInt(eventValue));\n  }; //volume handler\n\n\n  const handleVol = (event, volNum) => {\n    setVolNum(volNum);\n  }; //Animation Specific functions\n  //helper function for playHeadLoop()\n\n\n  const getPreviousSquare = () => {\n    if (counter === 0) {\n      return document.getElementById('31');\n    } else {\n      return document.getElementById(`${counter - 1}`);\n    }\n  }; // animates playhead based off the counter position\n\n\n  const playHeadLoop = () => {\n    //get the square to animate\n    let squareToAnimate = document.getElementById(`${counter}`); //find previousSquare\n\n    let previousSquare = getPreviousSquare(); //TODO Re-factor into one toggle\n\n    previousSquare.classList.remove('playhead');\n    previousSquare.classList.add('inactive');\n    squareToAnimate.classList.remove('inactive');\n    squareToAnimate.classList.add('playhead');\n  }; //when player is stopped reset playhead and array to initial values\n\n\n  const resetSquares = () => {\n    setCounter(0);\n    setPlayHeadArray(squares.map((square, i) => /*#__PURE__*/React.createElement(\"td\", {\n      key: i + squares,\n      id: i,\n      className: square > 0 ? 'playhead' : 'inactive cycle',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }\n    })));\n  }; //handles any changes user makes to instrument grid and updates values accordingly\n\n\n  const updateGrid = (row, column, toggle, color) => {\n    const clonedObj = { ...grid[row]\n    };\n    clonedObj[column] = toggle; //temporary const for setGrid\n\n    const arrayToPassSetGrid = [];\n\n    for (let i = 0; i < 16; i++) {\n      if (row === i) {\n        arrayToPassSetGrid.push(clonedObj);\n      } else {\n        arrayToPassSetGrid.push(grid[i]);\n      }\n    }\n\n    arr1[row].splice(column, 1, color);\n    setGrid(arrayToPassSetGrid);\n  }; //play an individual sound from our array from PlaySounds()\n\n\n  const playSound = source => {\n    var sound = new Howl({\n      src: [source],\n      html5: true,\n      volume: volNum / 100\n    });\n    sound.play();\n  }; //Iterate through the array of collected sounds compiled from our grid in loop()\n\n\n  const playSounds = array => {\n    for (let i = 0; i < array.length; i++) {\n      playSound(array[i]);\n    }\n  }; //collate all active sound samples on the current beat into an array from instruments\n\n\n  const loop = () => {\n    //create an array to hold our sounds for a beat\n    let soundArr = []; //loop through each instrument in our column\n\n    for (let j = 0; j < 16; j++) {\n      //if the square is active e.g. 0,0\n      if (grid[j][counter]) {\n        //set a temporary variable to hold our soundSrc\n        let soundSrc = instruments[j].name === 'Bassline' //e.g. \"./BassSamples/D-BassNote.wav\"\n        ? getBassNote(counter) : instruments[j].sound; //e.g. \"./DrumSamples/ClosedHats/HiHat01.wav\"\n\n        soundArr.push(soundSrc);\n      }\n\n      playSounds(soundArr);\n    }\n  }; //useEffect re-renders and runs our beat machine functions if IsPlaying per tick of setInterval\n\n\n  useEffect(() => {\n    //is the beat machine playing?\n    if (isPlaying) {\n      //set an interval to perform player logic\n      const interval = setInterval(() => {\n        //animate the playHead based on counter position\n        playHeadLoop(); // create an array of up to 6 sounds that are then played at the same time\n\n        loop(); // increments counter based on current tempo\n\n        if (counter < 31) {\n          setCounter(prevState => ++prevState);\n        } else {\n          setCounter(0);\n        }\n      }, beats);\n      return () => clearInterval(interval);\n    }\n\n    resetSquares();\n  }, [isPlaying, beats, volNum, counter]); //Map each instrumentRow onto the beat machine\n\n  const instrumentRows = instruments.map((instrument, row) => {\n    return /*#__PURE__*/React.createElement(InstrumentRow, {\n      key: row,\n      row: row,\n      updateGrid: (row, column, toggle, color) => updateGrid(row, column, toggle, color),\n      instrumentName: instrument.name,\n      instrumentSound: instrument.sound,\n      pattern: instrument.pattern,\n      instrumentColor: selectedColor,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 7\n      }\n    });\n  }); //Conditionally Render Playhead if isPlaying\n\n  const playHead = () => {\n    if (isPlaying) {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"td\", {\n        className: \"instrument\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }\n      }), playHeadArray);\n    } else {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"td\", {\n        className: isPlaying ? 'hidden' : 'instrument',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        className: \"inactive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }\n      }));\n    }\n  };\n\n  const handleClick = () => {\n    console.log(arr1);\n    alert('Creating NFT!');\n  };\n\n  const colorArray = arr1.toString();\n  const NFT = \"nameTest\"; //store playHeadComponent in a variable for readability\n\n  const playHeadComponent = playHead(); //App returns the composite of our beat machine and components\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"titleImg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(BeatMachine, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btnGroup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(PlayButton, {\n    onClick: togglePlay,\n    isPlaying: isPlaying,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(StopButton, {\n    onClick: togglePlay,\n    isPlaying: isPlaying,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"volTempo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"volStyle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Volume, {\n    volNum: volNum,\n    onChange: handleVol,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tempoStyle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Tempo, {\n    value: tempo,\n    onTempoChange: event => {\n      handleTempoChange(event);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"a\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 9\n    }\n  }, hideDrawingPanel, /*#__PURE__*/React.createElement(ColorPicker, {\n    color: selectedColor,\n    onChangeComplete: changeColor,\n    onSetColor: setColor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 1\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.colorSwatchContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 7\n    }\n  }, colorSwatch.map(color => /*#__PURE__*/React.createElement(\"div\", {\n    key: color,\n    onClick: () => setColor(color),\n    className: classes.colorSwatch,\n    style: {\n      background: color\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 11\n    }\n  }))))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    border: \"0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"tbody\", {\n    className: \"table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 9\n    }\n  }, playHeadComponent, instrumentRows)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(MintCluster, {\n    name: NFT,\n    array: colorArray,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 5\n    }\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/test/pixori-mint-test/src/App.js"],"names":["React","useEffect","useState","useMemo","Button","BeatMachine","InstrumentRow","Bpm","BeatLabel","CreateNft","Tempo","instruments","getBassNote","PlayButton","StopButton","Volume","Howl","Editor","useStyles","Colorbutton","Fragment","ColorPicker","MintCluster","arr1","Array","from","fill","offCell","on","color","initialCells","length","App","hideDrawingPanel","setHideDrawingPanel","cells","setCells","selectedColor","setColor","classes","colorSwatch","Set","filter","cell","map","chatString","slice","join","changeColor","hex","isPlaying","setIsPlaying","tempo","setTempo","volNum","setVolNum","squares","setSquares","playHeadArray","setPlayHeadArray","counter","setCounter","grid","setGrid","pattern","togglePlay","beats","handleTempoChange","event","eventValue","target","value","parseInt","handleVol","getPreviousSquare","document","getElementById","playHeadLoop","squareToAnimate","previousSquare","classList","remove","add","resetSquares","square","i","updateGrid","row","column","toggle","clonedObj","arrayToPassSetGrid","push","splice","playSound","source","sound","src","html5","volume","play","playSounds","array","loop","soundArr","j","soundSrc","name","interval","setInterval","prevState","clearInterval","instrumentRows","instrument","playHead","handleClick","console","log","alert","colorArray","toString","NFT","playHeadComponent","colorSwatchContainer","background"],"mappings":"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","sourcesContent":["import React, { useEffect, useState ,useMemo} from 'react';\r\nimport { Button } from '@material-ui/core';\r\n\r\nimport './styles/index.css';\r\nimport './styles/playhead.css';\r\nimport BeatMachine from './Components/BeatMachine';\r\nimport InstrumentRow from './Components/InstrumentRow';\r\nimport Bpm from './helpers/useBPM';\r\nimport BeatLabel from './Components/BeatLabel';\r\nimport CreateNft from './Components/CreateNft.jsx';\r\nimport Tempo from './Components/Tempo';\r\nimport { instruments, getBassNote } from './helpers/instruments';\r\nimport PlayButton from './Components/PlayButton';\r\nimport StopButton from './Components/StopButton';\r\n\r\nimport Volume from './Components/Volume';\r\nimport { Howl } from 'howler';\r\nimport Editor from \"./Editor\";\r\nimport useStyles from './App.styles';\r\nimport Colorbutton from \"./colorbutton\";\r\nimport { Fragment } from 'react';\r\n\r\nimport ColorPicker from './Components/ColorPicker.js';\r\nimport {MintCluster} from './clusters/mint-cluster'\r\n\r\nconst arr1= Array.from(Array(16), () => new Array(32).fill(0));\r\nconst offCell = {\r\n  on: false,\r\n  color: '#000000',\r\n};\r\nconst initialCells = Array.from({ length: 40 }, () => offCell);\r\n\r\nconst App = () => {\r\n\r\n  const [hideDrawingPanel, setHideDrawingPanel] = useState(true);\r\n\r\n\r\n  const [cells, setCells] = useState(initialCells);\r\n  const [selectedColor, setColor] = useState(\"000000\");\r\n\r\n  const classes = useStyles();\r\n  const colorSwatch = useMemo(\r\n    () => [\r\n      ...new Set(cells.filter((cell) => cell.on).map((cell) => cell.color)),\r\n    ],\r\n    [cells]\r\n  );\r\n\r\n  const chatString = useMemo(\r\n    () => cells.map((cell) => cell.color.slice(1)).join(','),\r\n    [cells]\r\n  );\r\n\r\n\r\n  function changeColor(color) {\r\n    setColor(color.hex);\r\n  }\r\n  //beat machine initial states\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [tempo, setTempo] = useState(120);\r\n  const [volNum, setVolNum] = useState(50);\r\n  // state tracking for playhead when isPlaying\r\n  const [squares, setSquares] = useState([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,]);\r\n  // state tracking for our dumb component when !isPlaying\r\n  const [playHeadArray, setPlayHeadArray] = useState([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,]);\r\n  const [counter, setCounter] = useState(0);\r\n  // holds on off state for each row of instruments\r\n  const [grid, setGrid] = useState([\r\n    instruments[0].pattern,\r\n    instruments[1].pattern,\r\n    instruments[2].pattern,\r\n    instruments[3].pattern,\r\n    instruments[4].pattern,\r\n    instruments[5].pattern,\r\n    instruments[6].pattern,\r\n    instruments[7].pattern,\r\n    instruments[8].pattern,\r\n    instruments[9].pattern,\r\n    instruments[10].pattern,\r\n    instruments[11].pattern,\r\n    instruments[12].pattern,\r\n    instruments[13].pattern,    \r\n    instruments[14].pattern,\r\n    instruments[15].pattern,\r\n  ]);\r\n\r\n  // TODO: Refactor player controls into helpers\r\n  const togglePlay = () => {\r\n    setIsPlaying(!isPlaying);\r\n  };\r\n\r\n  //set BPM\r\n  let beats = Bpm(tempo);\r\n\r\n  //ParseInt() as tempo field currently a string\r\n  const handleTempoChange = (event) => {\r\n    const eventValue = event.target.value;\r\n    setTempo(parseInt(eventValue));\r\n  };\r\n\r\n  //volume handler\r\n  const handleVol = (event, volNum) => {\r\n    setVolNum(volNum);\r\n  };\r\n\r\n  //Animation Specific functions\r\n  //helper function for playHeadLoop()\r\n  const getPreviousSquare = () => {\r\n    if (counter === 0) {\r\n      return document.getElementById('31');\r\n    } else {\r\n      return document.getElementById(`${counter - 1}`);\r\n    }\r\n  };\r\n\r\n  // animates playhead based off the counter position\r\n  const playHeadLoop = () => {\r\n    //get the square to animate\r\n    let squareToAnimate = document.getElementById(`${counter}`);\r\n    //find previousSquare\r\n    let previousSquare = getPreviousSquare();\r\n    //TODO Re-factor into one toggle\r\n    previousSquare.classList.remove('playhead');\r\n    previousSquare.classList.add('inactive');\r\n    squareToAnimate.classList.remove('inactive');\r\n    squareToAnimate.classList.add('playhead');\r\n  };\r\n\r\n  //when player is stopped reset playhead and array to initial values\r\n  const resetSquares = () => {\r\n    setCounter(0);\r\n    setPlayHeadArray(\r\n      squares.map((square, i) => (\r\n        <td\r\n          key={i + squares}\r\n          id={i}\r\n          className={square > 0 ? 'playhead' : 'inactive cycle'}\r\n        ></td>\r\n      ))\r\n    );\r\n  };\r\n\r\n  //handles any changes user makes to instrument grid and updates values accordingly\r\n  const updateGrid = (row, column, toggle,color) => {\r\n    const clonedObj = { ...grid[row] };\r\n    clonedObj[column] = toggle;\r\n    //temporary const for setGrid\r\n    const arrayToPassSetGrid = [];\r\n    for (let i = 0; i < 16; i++) {\r\n      if (row === i) {\r\n        arrayToPassSetGrid.push(clonedObj);\r\n      } else {\r\n        arrayToPassSetGrid.push(grid[i]);\r\n      }\r\n    }\r\n\r\n    arr1[row].splice(column,1,color)\r\n    setGrid(arrayToPassSetGrid);\r\n\r\n\r\n  };\r\n\r\n  //play an individual sound from our array from PlaySounds()\r\n  const playSound = (source) => {\r\n    var sound = new Howl({\r\n      src: [source],\r\n      html5: true,\r\n      volume: volNum / 100,\r\n    });\r\n    sound.play();\r\n  };\r\n\r\n  //Iterate through the array of collected sounds compiled from our grid in loop()\r\n  const playSounds = (array) => {\r\n    for (let i = 0; i < array.length; i++) {\r\n      playSound(array[i]);\r\n    }\r\n  };\r\n\r\n  //collate all active sound samples on the current beat into an array from instruments\r\n  const loop = () => {\r\n    //create an array to hold our sounds for a beat\r\n    let soundArr = [];\r\n    //loop through each instrument in our column\r\n    for (let j = 0; j < 16; j++) {\r\n      //if the square is active e.g. 0,0\r\n      if (grid[j][counter]) {\r\n        //set a temporary variable to hold our soundSrc\r\n        let soundSrc =\r\n          instruments[j].name === 'Bassline'\r\n          //e.g. \"./BassSamples/D-BassNote.wav\"\r\n            ? getBassNote(counter)\r\n            : instruments[j].sound;\r\n            //e.g. \"./DrumSamples/ClosedHats/HiHat01.wav\"\r\n        soundArr.push(soundSrc);\r\n      }\r\n      playSounds(soundArr);\r\n    }\r\n  };\r\n\r\n  //useEffect re-renders and runs our beat machine functions if IsPlaying per tick of setInterval\r\n  useEffect(() => {\r\n    //is the beat machine playing?\r\n    if (isPlaying) {\r\n      //set an interval to perform player logic\r\n      const interval = setInterval(() => {\r\n        //animate the playHead based on counter position\r\n        playHeadLoop();\r\n        // create an array of up to 6 sounds that are then played at the same time\r\n        loop();\r\n        // increments counter based on current tempo\r\n        if (counter < 31) {\r\n          setCounter((prevState) => ++prevState);\r\n        } else {\r\n          setCounter(0);\r\n        }\r\n      }, beats);\r\n      return () => clearInterval(interval);\r\n    }\r\n    resetSquares();\r\n  }, [isPlaying, beats, volNum, counter]);\r\n \r\n\r\n  //Map each instrumentRow onto the beat machine\r\n  const instrumentRows = instruments.map((instrument, row ) => {\r\n    return (\r\n      <InstrumentRow\r\n      \r\n        key={row}\r\n        row={row}\r\n        updateGrid={(row, column, toggle,color) => updateGrid(row, column, toggle,color)}\r\n        instrumentName={instrument.name}\r\n        instrumentSound={instrument.sound}\r\n        pattern={instrument.pattern}\r\n        instrumentColor={selectedColor}\r\n      />\r\n    );\r\n  });\r\n  \r\n\r\n  //Conditionally Render Playhead if isPlaying\r\n  const playHead = () => {\r\n    if (isPlaying) {\r\n      return (\r\n        <>\r\n          <td className=\"instrument\" />\r\n          {playHeadArray}\r\n        </>\r\n      );\r\n    } else {\r\n      return (\r\n        <>\r\n          <td className={isPlaying ? 'hidden' : 'instrument'} />\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n          <td className=\"inactive\"></td>\r\n        </>\r\n      );\r\n    }\r\n\r\n\r\n\r\n  };\r\n  const handleClick = () => {\r\n    console.log(arr1)\r\n    alert('Creating NFT!')\r\n  \r\n\r\n  }\r\n\r\n  const colorArray = arr1.toString();\r\n  const NFT = \"nameTest\";\r\n  \r\n\r\n  //store playHeadComponent in a variable for readability\r\n  const playHeadComponent = playHead();\r\n\r\n  //App returns the composite of our beat machine and components\r\n  return (\r\n    <Fragment>\r\n    <div className=\"container\">\r\n      <div className=\"titleImg\">\r\n        <BeatMachine />\r\n \r\n      </div>\r\n      <div className=\"btnGroup\">\r\n        <PlayButton onClick={togglePlay} isPlaying={isPlaying} />\r\n        <StopButton onClick={togglePlay} isPlaying={isPlaying} />\r\n      </div>\r\n      <br />\r\n      <div className=\"volTempo\">\r\n        <div className=\"volStyle\">\r\n          <Volume volNum={volNum} onChange={handleVol} />\r\n        </div>\r\n        <div className=\"tempoStyle\">\r\n          <Tempo\r\n            value={tempo}\r\n            onTempoChange={(event) => {\r\n              handleTempoChange(event);\r\n            }}\r\n          />\r\n        </div>\r\n        <div id=\"a\">\r\n    \r\n      {hideDrawingPanel}\r\n{/* <SwatchesPicker color={selectedColor} onChangeComplete={changeColor} />  */}\r\n<ColorPicker  color={selectedColor} onChangeComplete={changeColor} onSetColor={setColor} />\r\n      <div className={classes.colorSwatchContainer}>\r\n        {colorSwatch.map((color) => (\r\n          <div\r\n            key={color}\r\n            onClick={() => setColor(color)}\r\n            className={classes.colorSwatch}\r\n            style={{ background: color }}\r\n          />\r\n        ))}\r\n      </div>\r\n</div></div>\r\n      <br />\r\n      <table border=\"0\">\r\n        <tbody className=\"table\">\r\n          {playHeadComponent}\r\n          {instrumentRows}\r\n         \r\n        </tbody>\r\n      </table>\r\n    \r\n    <div>\r\n    <MintCluster name={NFT} array={colorArray} />\r\n    </div>\r\n\r\n    </div>\r\n    </Fragment>\r\n  );\r\n\r\n\r\n  \r\n};\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}